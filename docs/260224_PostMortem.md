# 2026/02/24 技術トラブル・振り返りレポート（Post-Mortem）

## 1. 発生した問題の概要
高品質 3D プレイヤー描画システムの「安定化」を試みた結果、逆にエディタの動作を不安定にさせ、Prefab を破損させるという重大な改悪を招きました。

## 2. トライアンドエラーの議事録と失敗の原因

### ① Prefab JSON の手動編集による破損
*   **試み**: `fix_prefabs.py` 等のスクリプトを使用し、Prefab の JSON 構造を直接書き換えて ID 整合性を取ろうとした。
*   **失敗**: Cocos Creator の Prefab 構造（`__id__` 参照）は高度に複雑であり、一部を書き換えると芋蔓形式で全体の整合性が崩れる。結果として root ノードが消失したり、コンポーネントのリンクが切れる致命的な破損を招いた。
*   **教訓**: Prefab はブラックボックスとして扱うべきであり、外部スクリプトでの大規模な JSON 改変は絶対に行ってはならない。

### ② 不正確なエンジン知識の提示
*   **試み**: `RawImage` コンポーネントの作成手順を提示。
*   **失敗**: Cocos Creator 3.8.8 における正確な名称（`Raw Image`：スペースあり）や、メニュー上の配置（`2D Object` 配下）を誤認し、存在しない項目を探させるという混乱を招いた。
*   **教訓**: バージョンごとの UI 差異を軽視せず、常にエンジンのドキュメントや実機の挙動と照らし合わせて確実な情報のみを提示すべきであった。

### ③ 不完全なエラーハンドリングによる無限ループ
*   **試み**: `onLoad` 時の `scheduleOnce` による「安全な初期化」の実装。
*   **失敗**: UI の初期化待ちチェックをリトライ制限なしで行ったため、特定の条件下で `Maximum call stack size exceeded`（無限ループによるスタックオーバーフロー）を発生させ、エディタをフリーズさせた。
*   **教訓**: 非同期処理を扱う際は、常に最大回数制限（タイムアウト）を設けた防衛的プログラミングを徹底すべきである。

## 3. 今後の再発防止策
1.  **エディタ第一原則**: Prefab やシーンの構築はエディタ上での手動操作の指示に留め、コード側は「不足していてもクラッシュしない（Defensive coding）」状態を維持するだけに止める。
2.  **JSON 編集の禁止**: 今後、Prefab ファイル（.prefab）の JSON を直接操作するスクリプトは作成・提案しない。
3.  **事実確認の徹底**: AI の「らしい」知識に頼らず、Web検索ツール等を用いてエンジンの正確な仕様を再確認してから指示に落とし込む。

---
本日の改悪により貴重な開発時間を浪費させてしまい、心より反省しております。
指示通り、関連する一時スクリプトはすべて破棄し、本レポートのみを成果物として残します。
