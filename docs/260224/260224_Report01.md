Cocos Creator 3.8.8ã®RenderTexture + 3D Playeræ§‹æˆãƒ¬ãƒãƒ¼ãƒˆã‚’æ‹è¦‹ã—ã¾ã—ãŸã€‚Prefab IDãšã‚Œã¨RenderTextureã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«åŒæœŸã¯å…¸å‹çš„ãªè½ã¨ã—ç©´ã§ã™ã€‚
ğŸ¯ 3ã¤ã®ç›¸è«‡ãƒã‚¤ãƒ³ãƒˆã¸ã®å›ç­”
1. Prefab JSONã®__id__å‚ç…§è¦å‰‡

ID=Index+1ãƒ«ãƒ¼ãƒ«ã¯æ­£ã—ã„ã§ã™ãŒã€æ‰‹å‹•ç·¨é›†æ™‚ã®è½ã¨ã—ç©´ãŒã‚ã‚Šã¾ã™ï¼š

text
æ­£ã—ã„æ§‹é€ ä¾‹ (Player.prefab):
{
  "_name": "Player",
  "_children": [
    {"__id__": 1},    // model3D (Index 0 + 1)
    {"__id__": 2},    // Player3DCamera (Index 1 + 1)
    {"__id__": 3}     // PlayerLight (Index 2 + 1)
  ],
  "1": { ... },      // model3Dã®å®Ÿä½“
  "2": { ... },      // Player3DCameraã®å®Ÿä½“
  "3": { ... }       // PlayerLightã®å®Ÿä½“
}

IDãšã‚Œé˜²ãæ–¹ï¼š

text
1. ã‚¨ãƒ‡ã‚£ã‚¿ã§Prefabç·¨é›† â†’ Apply ã§è‡ªå‹•IDæ•´åˆ
2. æ‰‹å‹•ç·¨é›†æ™‚ã¯ _childrené…åˆ—ã®é †åºã¨ã‚­ãƒ¼ç•ªå·ã‚’å¿…ãšåŒæœŸ
3. cc.CompPrefabInfo ã® fileId/rootUuid ã¯Prefabã‚¢ã‚»ãƒƒãƒˆã¨ä¸€è‡´

2. RenderTextureåˆæœŸåŒ–ã®å …ç‰¢ãƒ•ãƒ­ãƒ¼

start()ç›´æ’ƒã¯ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ™‚ã«_uiProps=nullã‚¨ãƒ©ãƒ¼ã®åŸå› ã§ã™ï¼š

ts
// å®‰å…¨ãªåˆæœŸåŒ–ï¼ˆæ¨å¥¨ï¼‰
onLoad() {  // start()ã‚ˆã‚Šå‰
    this.scheduleOnce(() => this.initRenderTexture(), 0);
}

private initRenderTexture() {
    if (this.playerImage._uiProps == null) {
        console.warn('UIæœªåˆæœŸåŒ–ã€1ãƒ•ãƒ¬ãƒ¼ãƒ å¾…æ©Ÿ');
        this.scheduleOnce(() => this.initRenderTexture(), 0);
        return;
    }
    
    // RenderTextureä½œæˆãƒ»åŒæœŸ
    const rt = new RenderTexture();
    rt.create(512, 512, { format: RenderTexture.FrameBufferFormat.RGBA8 });
    this.player3DCamera.targetTexture = rt;
    this.playerImage.texture = rt;
}

3. ãƒãƒ†ãƒªã‚¢ãƒ«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å‘½åï¼ˆui-blur.effectï¼‰

ã‚¨ãƒ‡ã‚£ã‚¿è­¦å‘Šå›é¿ã®æ­£ã—ã„æ›¸ãæ–¹ï¼š

ts
// âŒ è­¦å‘ŠãŒå‡ºã‚‹
mat.setProperty('blurAmount', 0.5);

// âœ… æ­£ã—ã„ï¼ˆtargetæŒ‡å®šï¼‰
const mat = this.blurMaterial;
mat.initialize({ effectName: 'ui-blur.effect' });
mat.setProperty('mainParams.blurAmount', 0.5, 0);  // slot=0

// ã¾ãŸã¯ UniformBlockæ–¹å¼
mat.setUniform('mainParams.blurAmount', 0.5);

ğŸš€ å®Ÿè£…æ”¹å–„ææ¡ˆ

å¾…ã£ã¦ã„ã‚‹TypeScriptã‚³ãƒ¼ãƒ‰ã‚’æ‹è¦‹æ¬¡ç¬¬ã€ä»¥ä¸‹ã®è¦³ç‚¹ã§å®Œå…¨ãƒ‡ãƒãƒƒã‚°æ¸ˆã¿ç‰ˆã‚’æä¾›ã—ã¾ã™ï¼š

text
1. Prefab IDæ•´åˆç¢ºèªã‚¹ã‚¯ãƒªãƒ—ãƒˆ
2. RenderTextureãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«å®Œå…¨åŒæœŸ
3. ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼/æœ¬ç•ªä¸¡å¯¾å¿œã®åˆæœŸåŒ–ãƒ•ãƒ­ãƒ¼
4. ui-blur.effectã®è­¦å‘Šå®Œå…¨æ¶ˆå»
5. å‹•çš„æœ€é©åŒ–ï¼ˆRTè§£åƒåº¦è‡ªå‹•èª¿æ•´ï¼‰